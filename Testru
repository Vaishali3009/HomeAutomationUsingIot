package com.rbs.bdd.domain.enums.model;



/**
 * Model representing error details used in SOAP error responses.
 * Includes return code, user-facing description, and system notification code/description.
 */
public class ErrorDetail {
    public final String returnCode;
    public final String description;
    public final String systemNotificationCode;
    public final String systemNotificationDesc;

    public ErrorDetail(String returnCode, String description, String systemNotificationCode, String systemNotificationDesc) {
        this.returnCode = returnCode;
        this.description = description;
        this.systemNotificationCode = systemNotificationCode;
        this.systemNotificationDesc = systemNotificationDesc;
    }
}

-----------------------------------------

package com.rbs.bdd.common;

import com.rbs.bdd.domain.enums.model.ErrorDetail;

/**
 * Centralized constants used for generating error responses in {@link com.rbs.bdd.application.service.AccountValidationService}.
 * <p>
 * This includes:
 * <ul>
 *     <li>XPath expressions used to locate and update XML response elements</li>
 *     <li>Predefined {@link ErrorDetail} instances used to represent different validation errors</li>
 * </ul>
 * These constants help ensure consistency across all error response transformations.
 */
public final class ErrorConstants {

    /**
     * Private constructor to prevent instantiation.
     */
    private ErrorConstants() {}

    // ─────────────────────────────────────────────────────
    // XPath Expressions for XML Node Updates
    // ─────────────────────────────────────────────────────

    /**
     * XPath to locate transactionId under responseId node.
     */
    public static final String XPATH_RESPONSE_ID_TXN_ID = "//*[local-name()='responseId']/*[local-name()='transactionId']";

    /**
     * XPath to locate transactionId under refRequestIds node.
     */
    public static final String XPATH_REF_REQUEST_TXN_ID = "//*[local-name()='refRequestIds']/*[local-name()='transactionId']";

    /**
     * XPath to locate cmdStatus node for command result status.
     */
    public static final String XPATH_CMD_STATUS = "//*[local-name()='cmdStatus']";

    /**
     * XPath to locate description node inside cmdNotifications block.
     */
    public static final String XPATH_CMD_DESCRIPTION = "//*[local-name()='cmdNotifications']/*[local-name()='description']";

    /**
     * XPath to locate timestamp node inside cmdNotifications block.
     */
    public static final String XPATH_TIMESTAMP = "//*[local-name()='cmdNotifications']/*[local-name()='timestamp']";

    /**
     * XPath to locate returnCode node inside cmdNotifications block.
     */
    public static final String XPATH_RETURN_CODE = "//*[local-name()='cmdNotifications']/*[local-name()='returnCode']";

    /**
     * XPath to locate description inside systemNotifications block.
     */
    public static final String XPATH_SYS_NOTIFICATION_DESC = "//*[local-name()='systemNotifications']/*[local-name()='description']";

    /**
     * XPath to locate returnCode inside systemNotifications block.
     */
    public static final String XPATH_SYS_NOTIFICATION_CODE = "//*[local-name()='systemNotifications']/*[local-name()='returnCode']";

    /**
     * XPath to locate the entire systemNotifications block node.
     */
    public static final String XPATH_SYS_NOTIFICATION_BLOCK = "//*[local-name()='systemNotifications']";

    // ─────────────────────────────────────────────────────
    // Predefined Error Responses
    // ─────────────────────────────────────────────────────

    /**
     * Error returned when the IBAN length is not 22 characters.
     */
    public static final ErrorDetail ERR_INVALID_IBAN_LENGTH = new ErrorDetail(
            "ERR006",
            "Length of IBAN is Invalid",
            "0013",
            "Length of IBAN is Invalid"
    );

    /**
     * Error representing a failure in DB2 SQL lookup for the sort code or account.
     */
    public static final ErrorDetail ERR_DB2_SQL = new ErrorDetail(
            "ERR006",
            "500|Service GRPUB.OA_GET_SORTCODE_DETAILS...(OA2.2105271236)...",
            null,
            null
    );

    /**
     * Error returned when the IBAN does not start with a valid GB country code.
     */
    public static final ErrorDetail ERR_WRONG_COUNTRY_CODE = new ErrorDetail(
            "0010",
            "Country code is not found in Db, try  with the correct country code",
            null,
            null
    );

    /*
     * Common error code used to representgeneral service or validation failure
     */
    public static final String ERROR_CODE_ERR06="ERROO6";

    /**
     * Error returned when MOD97 validation fails for the IBAN.
     */
    public static final ErrorDetail ERR_MOD97_IBAN = new ErrorDetail(
            ERROR_CODE_ERR06,
            "MOD97 failure for the IBAN",
            "0020",
            "MOD97 failure for the IBAN"
    );

    /**
     * Error returned when the UBAN length is not exactly 14 characters.
     */
    public static final ErrorDetail ERR_INVALID_UBAN_LENGTH = new ErrorDetail(
            ERROR_CODE_ERR06,
            "UBAN should be 14 digits",
            "0013",
            "UBAN should be 14 digits"
    );

    /**
     * Error returned when MOD97 validation fails for the UBAN.
     */
    public static final ErrorDetail ERR_MOD97_UBAN = new ErrorDetail(
            ERROR_CODE_ERR06,
            "MOD97 failure for the UBAN",
            "0020",
            "MOD97 failure for the UBAN"
    );
}

-----------------------------


package com.rbs.bdd.common;

import java.util.List;

/**
 * Centralized constants used across the application for:
 *
 *   IBAN and code value mappings
 *   File paths for static SOAP responses
 *   XPath expressions for XML manipulation
 *
 * These constants help standardize values and avoid repetition throughout the service layer,
 * particularly within the SOAP response handling and validation logic.
 */
public final class ServiceConstants {

    /**
     * Path to the default error SOAP response XML used when validation fails.
     */
    public static final String ERROR_XML_PATH = "error-response/error-response.xml";

    /**
     * Path to the schema validation-specific SOAP error response.
     */
    public static final String SCHEMA_VALIDATION_ERROR_XML = "error-response/CustomerRetrievalSchemaValidationError.xml";

    // ─────────────────────────────────────────────────────
    // IBAN Constants for Matching Configurations
    // ─────────────────────────────────────────────────────

    /**
     * Configured IBAN representing a Domestic-Restricted, Switched, Modulus Passed account.
     */
    public static final String IBAN_1 = "GB29NWBK60161331926801";

    /**
     * Configured IBAN representing a Domestic-Restricted, Not Switching, Modulus Passed account.
     */
    public static final String IBAN_2 = "GB82WEST12345698765437";

    /**
     * Configured IBAN representing a Domestic-Unrestricted, Switched, Modulus Passed account.
     */
    public static final String IBAN_3 = "GB94BARC10201530093422";

    public static final String NAMESPACE_URI_FOR_ACCOUNT_VALIDATION = "http://com/rbsg/soa/C040PaymentManagement/ArrValidationForPayment/V01/";
    public static final String NAMESPACE_URI_FOR_CUSTOMER_RETRIEVAL = "http://com/rbsg/soa/C040PaymentManagement/CustomerRetrievalForPayment/V01/ServiceParameters/V01/";


    /**
     * Configured IBAN representing a Domestic-Unrestricted, Not Switching, Modulus Failed account.
     */
    public static final String IBAN_4 = "GB33BUKB20201555555567";

    /**
     * List of all supported IBANs used for validation and suffix matching.
     */
    public static final List<String> ALL_IBANS = List.of(
            IBAN_1,
            IBAN_2,
            IBAN_3,
            IBAN_4
    );

    // ─────────────────────────────────────────────────────
    // Code Values for Identifying Account Type
    // ─────────────────────────────────────────────────────

    /**
     * Code value representing an international bank account (IBAN).
     */
    public static final String INTL_BANK_ACCOUNT = "InternationalBankAccountNumber";

    /**
     * Code value representing a UK basic bank account (UBAN).
     */
    public static final String UK_BASIC_BANK_ACCOUNT = "UKBasicBankAccountNumber";

    // ─────────────────────────────────────────────────────
    // Static Response XML Paths
    // ─────────────────────────────────────────────────────

    /**
     * Path to the static success SOAP response XML used when business rules pass.
     */
    public static final String RESPONSE_XML_PATH = "static-response/account-validation/success-response.xml";

    // ─────────────────────────────────────────────────────
    // XPath Expressions for XML Node Access/Manipulation
    // ─────────────────────────────────────────────────────

    /**
     * XPath to locate any transactionId in the response.
     */
    public static final String XPATH_TRANSACTION_ID = "//*[local-name()='transactionId']";

    /**
     * XPath to locate the firstname in the customer retrieval response
     */
    public static final String XPATH_FIRST_NAME = "//*[local-name()='hasInvolvedPartyAssociation']" +
            "/*[local-name()='associatedInvolvedParty']" +
            "/*[local-name()='hasForName']" +
            "/*[local-name()='firstName']";

    /**
     * XPath to locate the prefixType in the customer retrieval response
     */
    public static final String XPATH_PREFIX_TYPE = "//*[local-name()='hasInvolvedPartyAssociation']" +
            "/*[local-name()='associatedInvolvedParty']" +
            "/*[local-name()='hasForName']" +
            "/*[local-name()='prefixTitle']" +
            "/*[local-name()='codeValue']";


    /**
     * XPath to locate the lastname in the customer retrieval response
     */
    public static final String XPATH_LAST_NAME = "//*[local-name()='hasInvolvedPartyAssociation']" +
            "/*[local-name()='associatedInvolvedParty']" +
            "/*[local-name()='hasForName']" +
            "/*[local-name()='lastName']";

    /**
     * XPath to locate account status under accountingUnits.
     */
    public static final String XPATH_ACCOUNT_STATUS = "//*[local-name()='accountingUnits']/*[local-name()='status']/*[local-name()='codeValue']";

    /**
     * XPath to locate switching status value.
     */
    public static final String XPATH_SWITCHING_STATUS = "//*[local-name()='switchingStatus']/*[local-name()='codeValue']";

    /**
     * XPath to locate modulus check status code value.
     */
    public static final String XPATH_MODULUS_STATUS = "//*[local-name()='modulusCheckStatus']/*[local-name()='codeValue']";

    // ─────────────────────────────────────────────────────
    // XPath Expressions for Fault/Error Response Nodes
    // ─────────────────────────────────────────────────────

    /**
     * XPath to locate transactionId inside refRequestIds in a SOAP Fault response.
     */
    public static final String XPATH_FAULT_TRANSACTION_ID = "//*[local-name()='refRequestIds']/*[local-name()='transactionId']";

    /**
     * XPath to locate the full responseId block in a SOAP Fault.
     */
    public static final String XPATH_FAULT_RESPONSE_ID = "//*[local-name()='responseId']";

    /**
     * XPath to locate the timestamp node in a SOAP Fault.
     */
    public static final String XPATH_FAULT_TIMESTAMP = "//*[local-name()='timestamp']";


    /**
     * XML Tage name used to identify the transactionId element in the request
     */
    public static final String TAG_TRANSACTION_ID= "transactionId";

    /**
     * Private constructor to prevent instantiation.
     */
    private ServiceConstants() {
        // Prevent instantiation
    }
}
