package com.rbs.bdd.application.service;

import com.rbs.bdd.application.port.out.AccountValidationPort;
import com.rbsg.soa.c040paymentmanagement.arrvalidationforpayment.v01.ValidateArrangementForPaymentRequest;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.ws.WebServiceMessage;

import static org.mockito.Mockito.*;

class PaymentOrchestratorTest {

    private AccountValidationPort accountValidationPort;
    private PaymentOrchestrator orchestrator;
    private ValidateArrangementForPaymentRequest mockRequest;
    private WebServiceMessage mockMessage;

    @BeforeEach
    void setUp() {
        accountValidationPort = mock(AccountValidationPort.class);
        orchestrator = new PaymentOrchestrator(accountValidationPort);
        mockRequest = mock(ValidateArrangementForPaymentRequest.class);
        mockMessage = mock(WebServiceMessage.class);
    }

    @Test
    void validateArrangementForPayment_shouldDelegateToPorts() {
        // Act
        orchestrator.validateArrangementForPayment(mockRequest, mockMessage);

        // Assert
        verify(accountValidationPort).validateSchema(mockRequest);
        verify(accountValidationPort).validateBusinessRules(mockRequest, mockMessage);
    }
}
